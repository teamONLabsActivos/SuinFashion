if (self.CavalryLogger) { CavalryLogger.start_js(["\/5qtLv3"]); }

__d("AbstractCommentLiveTypingXHRController",["destroyOnUnload","err"],(function(a,b,c,d,e,f){"use strict";var g={START:"start",STOP:"stop"},h=10*1e3;a=function(){function a(a,c,d,e){e===void 0&&(e=null),this.$5=a,this.$6=c,this.$7=d,this.$1=e,this.$2=!1,this.$3=0,this.$4=null,b("destroyOnUnload")(this.destroy.bind(this))}var c=a.prototype;c.destroy=function(){this.$1&&this.$1.destroy(),this.$1=null,this.$2=!1,this.$3=0,this.$4=null};c.bootloadPublisherModule=function(a){throw b("err")("bootloadPublisherModule not implemented, should be overridden by subclass")};c.$8=function(a){a=new a(this.$5,this.$6,this.$7);var b=Date.now(),c=this.$3;if(c&&c+h>=b){c=this.$4;c===g.START?a.handleStartEvent():c===g.STOP&&a.handleStopEvent()}this.$1=a};c.$9=function(){if(this.$2||!this.$5)return;this.$2=!0;this.bootloadPublisherModule(this.$8.bind(this))};c.attemptPublishStartEvent=function(){this.$4=g.START,this.$3=Date.now(),this.$1?this.$1.handleStartEvent():this.$2||this.$9()};c.attemptPublishStopEvent=function(){this.$4=g.STOP,this.$3=Date.now(),this.$1?this.$1.handleStopEvent():this.$2||this.$9()};return a}();e.exports=a}),null);
__d("MComposerLiveTypingController",["AbstractCommentLiveTypingXHRController","Bootloader"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(b,c,d){return a.call(this,b,c,d)||this}var d=c.prototype;d.bootloadPublisherModule=function(a){b("Bootloader").loadModules(["MComposerLiveTypingPublisher"],a,"MComposerLiveTypingController")};d.attemptPublishStartEvent=function(){a.prototype.attemptPublishStartEvent.call(this)};d.attemptPublishStopEvent=function(){a.prototype.attemptPublishStopEvent.call(this)};return c}(b("AbstractCommentLiveTypingXHRController"));e.exports=a}),null);
__d("MCommentComposer",["cx","CSS","ChannelClientID","ClientIDs","DOM","MComposerConfig","MComposerLiveTypingController","MLegacyDataStore","MMultiPhotoUploaderAttachmentState","MParent","MUFIInlineRepliesFunnelLogConfig","MViewport","Stratcom","StratcomManager","SubscriptionsHandler","TouchEventType","cancelAnimationFrame","debounceCore","ge","getActiveElement","requestAnimationFrame","setTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){var h=b("MUFIInlineRepliesFunnelLogConfig").MUFIInlineReplyComposerFunnelLogger,i="m-ufi",j="feed-ufi",k="scroll-area",l="m-composer",m="m-photo-composer",n="m-inline-reply-composer",o="m-noninline-composer",p="textarea",q="privacy-selector",r="composer-submit",s="inline-reply",t="comment",u=100,v=b("MComposerConfig").MComposerLoggingController,w=!1;function x(){return!!b("MComposerConfig").PUBLISH_LIVE}function y(a){if(a.tagName==="FORM")return a;else return b("DOM").find(a,"form")}a=function(){function a(a,c){var d=this;this.destroy=function(){d.$7.release(),d.$19(),d.$15&&d.$15.destroy(),d.$15=null,d.$3&&d.$3.destroy(),d.$3=null};this.$26=function(a){a=a.getNode(l);if(a==null||!d.$44(a))return;var c=b("DOM").find(a,"*",p);d.$22(a);b("MLegacyDataStore").get(a).disable_auto_scroll||b("MViewport").scrollToNode(c)};this.$27=function(a){a=a.getNode(l);if(!a||!d.$44(a))return;b("CSS").removeClass(a,"composerClosed")};this.$24=function(a){var b=a.getNode(p);if(!(b instanceof HTMLInputElement||b instanceof HTMLTextAreaElement)||!d.$44(b))return;b=b.value;var c=d.$4;b!==c&&(b&&b.trim().length?d.$45():d.$39());d.$10(a);d.$4=b};this.$29=function(a){a=a.getData();var c=b("ge")(a.input_id);if(!c)return;c=b("MParent").bySigil(c,m);if(!c)return;c=b("DOM").find(c,"*",l);if(!d.$44(c))return;d.$12=a;d.$20(c);d.$22(c)};this.$30=function(a){a=a.getNode(l);if(!d.$44(a))return;d.$9||d.$22(a);d.$9=!1};this.$31=function(a){a=a.getNode(l);if(!d.$44(a))return;d.$20(a);d.$22(a);d.$23(a);d.$39()};this.$38=function(a){a=a.getTarget();if(!a||!d.$44(a))return;var c=b("DOM").scry(a,"input","mcomposer-client-id");c.length?c[0].setAttribute("value",b("ClientIDs").getNewClientID()):(c=b("DOM").create("input",{name:"client_id",sigil:"mcomposer-client-id",type:"hidden",value:b("ClientIDs").getNewClientID()}),a.appendChild(c));c=b("DOM").scry(a,"input","mcomposer-session-id");c.length||(c=b("DOM").create("input",{name:"session_id",sigil:"mcomposer-session-id",type:"hidden",value:b("ChannelClientID").getID()}),a.appendChild(c));x()&&d.$39();d.$46()};this.$43=function(a){a=a.getData().textInput;if(!d.$44(a))return;d.$46()};this.$32=function(a){var c=a.getNode(r);if(c==null)return;var e=b("MLegacyDataStore").get(c);if(c instanceof HTMLElement&&!e.onclickIsSet){a=a.getNode(l);if(!a||!d.$44(a))return;var f=b("DOM").find(a,"*",p);c.onclick=function(){f.blur()};e.onclickIsSet=!0}};this.$37=function(a){a=a.getData().element;if(!a||!b("DOM").contains(a,d.$1))return;a=b("DOM").find(d.$1,"*",l);var c=b("DOM").find(a,"*",p);a=b("DOM").scry(a,"*","m-mentions-root")[0];a=a&&b("MLegacyDataStore").get(a);a=a||{};a=a.mentionsInstance;var e=a&&a.getIgnoreFocusChange();a&&a.setIgnoreFocusChange(!0);c.blur();a&&a.setIgnoreFocusChange(e)};this.$33=function(a){a=a.getNode(l);if(!d.$44(a))return;a=b("DOM").find(a,"*",p);d.$15&&d.$15.logSubmit(a.value.length,d.$12[b("MMultiPhotoUploaderAttachmentState").UPLOADED],a.form);b("Stratcom").invoke("marauder-feedback-posted",null,{});d.$39()};this.$36=function(a){a=a.getNode(i);if(!a||!b("DOM").contains(a,d.$1))return;a=b("DOM").find(d.$1,"*",l);a=b("DOM").find(a,"*",p);a.focus()};this.$34=function(a){a=a.getData();a=a.target_id;d.$13&&a!==d.$2.target_id&&d.destroy()};this.$35=function(a){var c=b("getActiveElement")();if(c&&b("Stratcom").hasSigil(c,"textarea")&&d.$44(c)&&b("MParent").bySigil(c,m)){d.$9=!0;c.blur();d.$9=!1;d.$19();a=function(){d.$19();c.blur();var a=b("DOM").scry(d.$1,"*",l)[0];a&&d.$22(a)};var e=new(b("SubscriptionsHandler"))();e.addSubscriptions(b("Stratcom").listen("focus",null,a.bind(d)),b("Stratcom").listen(b("TouchEventType").START,null,a.bind(d)));d.$8=e}};this.$40=function(a){a=a.getData();a=a.input;a=d.$47(a);if(!a)return;d.$15&&d.$15.logInitPhoto()};this.$42=function(a){a=a.getData();var c=a.ufi;a=a.logKeys;if(!c||!a||!b("DOM").contains(c,d.$1))return;a.forEach(function(a){return d.$15&&d.$15.logRender(a)})};this.$41=function(a){a=a.getData();var c=a.commentNode;a=a.loggingInteractionKey;if(!c||!a)return;var e=b("Stratcom").hasSigil(c,s),f=null;if(d.$14&&e){var g=b("MParent").bySigil(c.parentNode,t);f=g&&b("DOM").scry(g,"*",n)[0]}else if(!e&&!d.$14){f=b("MParent").bySigil(c,m);if(!f&&d.$13){g=b("MParent").bySigil(c,j);f=b("DOM").scry(g,"*",o)[0]}}else return;e=f&&b("DOM").scry(f,"*",l)[0];if(!d.$44(e))return;d.$15&&d.$15.logRender(a)};this.$39=function(){if(!x())return;d.$48();d.$3&&d.$3.attemptPublishStopEvent()};this.$25=function(){d.$2.should_focus&&d.$2.input_id?b("setTimeoutAcrossTransitions")(function(){b("ge")(d.$2.input_id).focus(),d.$2.is_comments_permalink?b("MViewport").scrollToTop():b("ge")(d.$2.composer_id).scrollIntoView()},0):d.$2.should_anchor&&d.$2.composer_id?b("ge")(d.$2.composer_id).scrollIntoView():d.$2.should_anchor_reactions||b("MViewport").scrollToTop(),d.$16&&d.$16.remove()};this.$28=function(a){if(d.$2.send_with_softkey&&a.getSpecialKey()==="return"){a=a.getNode(l);var c=b("getActiveElement")();c&&c.blur();b("DOM").find(a,"*",r).click()}};this.$1=a;this.$2=c||{};this.$3=null;this.$4=null;this.$5=!!this.$2.toggle_submit;this.$10=this.$17();this.$12=b("MMultiPhotoUploaderAttachmentState").getDefaultState();this.$13=!!b("MParent").bySigil(a,j);this.$14=!!(this.$2.is_inline_reply&&b("MParent").bySigil(this.$1,n));this.$15=null;this.$2.log_comment&&v&&(this.$15=new v());this.$8=null;this.$9=!1;this.$7=new(b("SubscriptionsHandler"))();this.$18();b("Stratcom").invoke("marauder-fb-composer-init",null,{parent_fbid:"target_id"in this.$2?this.$2.target_id:-1})}var c=a.prototype;c.$19=function(){this.$8&&this.$8.release(),this.$8=null};c.$20=function(a){var c=this;if(!this.$5||!a)return;this.$6&&b("cancelAnimationFrame")(this.$6);this.$6=b("requestAnimationFrame")(function(){c.$6=null;var d=b("DOM").find(a,"*",r),e=c.$12[b("MMultiPhotoUploaderAttachmentState").SENDING]===0&&(!/^\s*$/.test(b("DOM").find(a,"*",p).value)||c.$12[b("MMultiPhotoUploaderAttachmentState").UPLOADED]>0);!e?d.setAttribute("disabled",!0):d.removeAttribute("disabled");b("CSS").conditionClass(d,"_56bt",!e);b("CSS").conditionClass(d,"_56bv",e);b("CSS").conditionClass(d,"_653w",e)})};c.$21=function(a){var c=this;a===this.$2.composer_id&&(this.$11=!0,b("setTimeout")(function(){c.$11=!1},u))};c.$22=function(a){var c=y(a);if(!a||!b("MLegacyDataStore").get(a).auto_collapse||!c||!b("MLegacyDataStore").get(c).expand_composer)return;c=b("DOM").find(a,"*",p);c=b("getActiveElement")()===c||!/^\s*$/.test(c.value)||this.$12[b("MMultiPhotoUploaderAttachmentState").UPLOADED]>0;if(!c&&this.$11)return;b("CSS").conditionClass(a,"composerClosed",!c)};c.$23=function(a){var c=b("DOM").find(a,"*","m-comment-conversation-guide-session-id");c&&(c.value="");c=b("DOM").find(a,"*","m-comment-conversation-guide-shown");c&&(c.value="none")};c.$18=function(){var a=this,c=x()?this.$24.bind(this):this.$10.bind(this);this.$2.isPageletified?this.$25():(this.$16=b("Stratcom").listen(["m:page:render:complete","m:schedulable:loaded"],null,this.$25.bind(this)),this.$7.addSubscriptions(this.$16));this.$7.addSubscriptions(b("Stratcom").listen("MCommentComposer:replyButtonClick",null,function(b){return a.$21(b.getData().composerID)}),b("Stratcom").listen("MCommentComposer:conversationGuideItemClick",null,function(b){return a.$21(b.getData().composerID)}),b("Stratcom").listen("focus",[l,p],this.$26.bind(this)),b("Stratcom").listen("focus",[l,q],this.$27.bind(this)),b("Stratcom").listen("keyup",[l,p],c),b("Stratcom").listen("keydown",[l,p],this.$28.bind(this)),b("Stratcom").listen("input",[l,p],c),b("Stratcom").listen("paste",[l,p],c),b("Stratcom").listen("MMultiPhotoUploader:attachments:change",null,this.$29.bind(this)),b("Stratcom").listen("blur",[l,p],this.$30.bind(this)),b("Stratcom").listen("reset",[l],this.$31.bind(this)),b("Stratcom").listen("touchend",[l,r],this.$32.bind(this)),b("Stratcom").listen("click",r,this.$33.bind(this)),b("Stratcom").listen("m:page:unload",null,this.destroy.bind(this)),b("Stratcom").listen("m:feed-ufi-flyout:reset",null,this.$34.bind(this)),this.$10);b("MComposerConfig").CAN_TOUCH_PHOTO_INPUT_WHILE_EXPANDED&&this.$7.addSubscriptions(b("Stratcom").listen("MMultiPhotoUploader:input:click",null,this.$35.bind(this)));this.$14||this.$7.addSubscriptions(b("Stratcom").listen("click","m-add-comment",this.$36.bind(this)));this.$13&&b("MParent").bySigil(this.$1,k)&&this.$7.addSubscriptions(b("Stratcom").listen("MScrollArea:scrollstart",null,this.$37.bind(this)));w||(w=!0,b("StratcomManager").enableDispatch(window,"reset"));this.$7.addSubscriptions(b("Stratcom").listen("submit",l,this.$38.bind(this)));x()&&this.$7.addSubscriptions(b("Stratcom").listen("m:feed-ufi:hide",null,this.$39.bind(this)));this.$15&&(this.$7.addSubscriptions(b("Stratcom").listen("MMultiPhotoUploader:input:change",null,this.$40.bind(this)),b("Stratcom").listen("m:ufi:iui:comment-added",null,this.$41.bind(this))),this.$14||this.$7.addSubscriptions(b("Stratcom").listen("m:ufi:live-comments:render",null,this.$42.bind(this))));this.$2.is_inline_reply&&h&&this.$7.addSubscriptions(b("Stratcom").listen("m:ufi:sticker-comment",null,this.$43.bind(this)))};c.$44=function(a){return!!a&&b("DOM").contains(this.$1,a)};c.$17=function(){var a=this;return b("debounceCore")(function(c){var d=c.getNode(p);if(!(d instanceof HTMLInputElement||d instanceof HTMLTextAreaElement)||!a.$44(d))return;b("Stratcom").invoke("marauder-feedback-input",null,{draft:d.value});a.$15&&a.$15.logInitText();a.$20(c.getNode(l))},250)};c.$46=function(){this.$2.is_inline_reply&&h&&h.logReplySubmitted(this.$2.target_id)};c.$47=function(a){if(!a)return null;a=b("MParent").bySigil(a,m);a=a&&b("DOM").scry(a,"*",l)[0];return a&&this.$44(a)?a:null};c.$48=function(){this.$2&&this.$2.target_id&&!this.$3&&x()&&(this.$3=new(b("MComposerLiveTypingController"))(this.$2.target_id,this.$2.parent_comment_id,this.$2.actor_id))};c.$45=function(){if(!x())return;this.$48();this.$3&&this.$3.attemptPublishStartEvent()};return a}();e.exports=a}),null);