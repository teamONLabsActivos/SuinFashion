if (self.CavalryLogger) { CavalryLogger.start_js(["ttFvw0M"]); }

__d("MAddFriendNew",["DOM","MFriendingState","MLegacyDataStore","Stratcom"],(function(a,b,c,d,e,f){var g="m-add-friend-flyout",h="m-cancel-request";a=function(a,c,d){var e=this;this.onFriendRequestCanceled=function(a){a=a.getData();if(!a||a.userid!==e.userid)return;a=b("DOM").scry(e.unit,"*",g)[0];var c=b("DOM").scry(e.unit,"*",h)[0];b("MLegacyDataStore").get(a).not_friendable||b("DOM").show(a);b("DOM").hide(c)};this.onFriendRequestSent=function(a){a=a.getData();if(!a||a.userid!==e.userid)return;a=b("DOM").scry(e.unit,"*",g)[0];var c=b("DOM").scry(e.unit,"*",h)[0];b("DOM").hide(a);b("DOM").show(c)};this.unit=d;this.userid=c;b("Stratcom").listen(b("MFriendingState").REQUEST_SENT,null,this.onFriendRequestSent.bind(this));b("Stratcom").listen(b("MFriendingState").REQUEST_CANCELED,null,this.onFriendRequestCanceled.bind(this))};e.exports=a}),null);
__d("MFriendDynamicSubtitle",["cx","DOM","MAnimation","MFriendingActionError","MFriendingState","MParent","Stratcom"],(function(a,b,c,d,e,f,g){var h="undoable-action",i="m-add-friend-request-sent",j="m-friend-request-canceled",k="m-friend-unfriended",l="m-add-friend-source-replaceable",m="m-friend-request-highlight-notice";a=function(){function a(a,c){var d=this;this.$7=function(a){a=a.getData();if(!a||!a.userid||a.userid!=d.$2)return;if(!a.error)return;d.$8(a.error)};this.$5=function(a){var b=a.getData();if(!b||!b.userid||b.userid!=d.$2)return;b=a.getType();d.$8(b)};this.$6=function(){for(var a=0;a<d.$4.length;a++)d.$4[a].remove()};this.$1=a;this.$2=c;this.$3=b("MParent").bySigil(a,h);this.$4=[b("Stratcom").listen([b("MFriendingActionError").SEND_OUTGOING_REQUEST_ERROR,b("MFriendingActionError").CANCEL_OUTGOING_REQUEST_ERROR,b("MFriendingState").REQUEST_SENT,b("MFriendingState").REQUEST_CANCELED,b("MFriendingState").UNFRIENDED],null,this.$5.bind(this)),b("Stratcom").listen("m:page:unload",null,this.$6.bind(this)),b("Stratcom").listen("friending_state_change",null,this.$7.bind(this))]}var c=a.prototype;c.$8=function(a){this.$9(),a===b("MFriendingState").REQUEST_SENT||a===b("MFriendingActionError").CANCEL_OUTGOING_REQUEST_ERROR?this.$10(i):a===b("MFriendingState").REQUEST_CANCELED?this.$10(j):a===b("MFriendingState").UNFRIENDED?this.$10(k):a===b("MFriendingActionError").SEND_OUTGOING_REQUEST_ERROR&&this.$10(l),this.$11()};c.$9=function(){this.$12(i),this.$12(l),this.$12(j),this.$12(k)};c.$12=function(a){a=b("DOM").scry(this.$3,"*",a)[0];a&&b("DOM").hide(a)};c.$10=function(a){a=b("DOM").scry(this.$3,"*",a)[0];a&&b("DOM").show(a)};c.$11=function(){var a=b("DOM").scry(this.$3,"*",m)[0];a&&b("MAnimation").animate(a,"_4z0z",4e3)};return a}();e.exports=a}),null);
__d("MFriendingAutoScroll",["MAnimator","MFriendingState","MViewport","Stratcom"],(function(a,b,c,d,e,f){f.setup=a;var g=400,h=101,i,j,k,l;function a(){n();var a=b("Stratcom").listen("m:page:unload",null,function(){a.remove(),o()})}function m(){var a=b("MViewport").getScrollPos().y,c=function(c){b("MViewport").scrollTo(0,a+c*h)};new(b("MAnimator"))().start(c,null,function(){},g)}function n(){var a;o(!0);i=(a=b("Stratcom")).listen([b("MFriendingState").REQUEST_SENT],null,m);j=a.listen("click","confirm-request",m);k=a.listen("click",["nav-popover","feed"],o);l=a.listen("click",["nav-popover","requests","icon"],n)}function o(a){a===void 0&&(a=!1),i&&i.remove(),j&&j.remove(),k&&k.remove(),a===!0&&l&&l.remove()}}),null);
__d("MFriendsActionBubble",["DOM","MLegacyDataStore","MURI","Stratcom"],(function(a,b,c,d,e,f){var g="m-unfriend-request",h="/friendlists/edit",i="manage-friend-list",j="m-follow-request",k="m-unfollow-request";a=function(){function a(a){var c=this;this.$3=function(a){var d=c.$1.getContentRoot(),e=a.getNode("popup-action-trigger"),f=b("DOM").scry(d,"*",g)[0];c.$5(e,f,a);f=b("DOM").scry(d,"*",i)[0];c.$5(e,f,a);c.$6(e,d,a)};this.$4=function(a){var d=a.getNode(i);if(d!=null){d=b("MLegacyDataStore").get(d);d=new(b("MURI"))(h).setQueryData({subject_id:d.id,ref_param:d.manage_list_ref});c.$7(d,a)}};this.$1=a;this.$2=null}var c=a.prototype;c.enable=function(){this.$2=[b("Stratcom").listen("click","are-friends-popup",this.$3.bind(this)),b("Stratcom").listen("click",i,this.$4.bind(this))]};c.$6=function(a,c,d){if(a==null)return;var e=b("MLegacyDataStore").get(a).is_following;if(e===null)return;var f=b("DOM").scry(c,"*",k)[0];this.$5(a,f,d);c=b("DOM").scry(c,"*",j)[0];this.$5(a,c,d);e?(b("DOM").show(f),b("DOM").hide(c)):(b("DOM").show(c),b("DOM").hide(f))};c.$5=function(a,c,d){if(!a||!c)return;a=b("MLegacyDataStore").get(a);a.flyoutEvent=d;b("MLegacyDataStore").set(c,a)};c.$7=function(a,c){window.FW_ENABLED||!window.APP_ENABLED?(c.kill(),window.location.href=a.toString()):b("Stratcom").invoke("go",null,{uri:a})};c.disable=function(){while((a=this.$2)==null?void 0:a.length){var a;this.$2.pop().remove()}};return a}();e.exports=a}),null);
__d("XFeedEgoLoadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ego/feed/load/",{loading_id:{type:"String",required:!0},ids:{type:"IntVector",required:!0},service_id:{type:"String",required:!0},replace_data:{type:"String",defaultValue:""},location:{type:"String",defaultValue:""},group_size:{type:"Int",defaultValue:1},qid:{type:"Int",required:!0},mf_story_key:{type:"Int",required:!0}})}),null);
__d("MSwipeInfiniteScrollerLoadMore",["csx","DOM","DataAttributeUtils","MLegacyDataStore","MRequest","MRequestTypes","MURI","Parent","XFeedEgoLoadController"],(function(a,b,c,d,e,f,g){var h=0,i=200;function a(a){var c=b("DOM").scry(a,"*","m-infinite-swipe-loading")[0];if(!c)return;var d=b("MLegacyDataStore").get(c);if(d.processing)return;b("MLegacyDataStore").set(c,{processing:!0});if(d.use_uri){new(b("MRequest"))(new(b("MURI"))(d.uri).toString()).setType(b("MRequestTypes").DEPENDENT).send();return}d=[];a=a.children;var e,f;for(var g=0;g<a.length;g++){g===0&&(f=a[g].getAttribute("data-service"));var h=b("DataAttributeUtils").getDataFt(a[g]);if(!h)continue;g===0&&(e=JSON.parse(h));h=JSON.parse(h).ego_id;d.push(h)}h=b("XFeedEgoLoadController").getURIBuilder().setString("loading_id",c.id).setIntVector("ids",d).setString("service_id",f||"pymk").setString("location","inline_feed").setInt("qid",e.qid).setInt("mf_story_key",e.mf_story_key).getURI();g=new(b("MRequest"))(new(b("MURI"))(h).toString()).setType(b("MRequestTypes").DEPENDENT);a=function(){var a=b("Parent").bySelector(c,".scrollArea");j(a.id);b("MLegacyDataStore").set(c,{processing:!1})};g.listen("done",a.bind(this));g.send()}function j(a){a=document.getElementById(a);if(!a)return;var c=b("MLegacyDataStore").get(a);if(!c||!c.scrollArea)return;var d=b("DOM").scry(a,"*","m-swipe-pymk-item")[0];d=b("DataAttributeUtils").getDataAttribute(d,"data-unit-size");d||(d=i);var e=c.scrollArea;if(e.getAutomaticPaging())e.reflow("auto");else{e=b("DOM").find(a,"*","scroll-area-body").children;a=[h];for(var f=1;f<e.length;f++)a[f]=a[f-1]+parseInt(d,10);c.scrollArea.reflow(a)}}e.exports={maybeLoadMore:a,reflow:j}}),null);
__d("XEgoHideLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ego/feed/logging/xout/",{ego_id:{type:"Int",required:!0},qid:{type:"Int",required:!0},mf_story_key:{type:"Int",required:!0},service_id:{type:"String",required:!0}})}),null);
__d("XEgoPYMIActionsLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/pymi/logging/",{action:{type:"String",required:!0},invitee_name:{type:"String"},qid:{type:"Int"},mf_story_key:{type:"String"},ego_id:{type:"Int"},how_found:{type:"String"}})}),null);
__d("XFeedEgoImpressionLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ego/feed/logging/impression/",{})}),null);
__d("MSwipeInfiniteScroller",["cx","CSS","DOM","DataAttributeUtils","MFriendingState","MLegacyDataStore","MParent","MRequest","MScrollAreaHelper","MSwipeInfiniteScrollerLoadMore","Stratcom","XEgoHideLoggingController","XEgoPYMIActionsLoggingController","XFeedEgoImpressionLoggingController"],(function(a,b,c,d,e,f,g){f.logImpressionForElement=j;var h=3,i={};({});function a(a){var c=a.getData().event;if(!c.getNode("m-swipe-pymk-item")&&!c.getNode("m-swipe-pysf-item"))return;var d=c.getTarget(),e=b("MLegacyDataStore").get(d);e._delayTimer&&window.clearTimeout(e._delayTimer);e._delayTimer=window.setTimeout(function(){e.scrollArea===void 0&&(e.scrollArea=b("MScrollAreaHelper").findScrollArea(d,14)),e.scrollArea&&(e.scrollArea.scrollByPages(1),b("Stratcom").invoke("MSwipeInfiniteScroller:autoScrollStart",null,c))},1e3);e._touchstartListener&&e._touchstartListener.remove();e._touchstartListener=b("Stratcom").listen("touchstart",null,function(a){window.clearTimeout(e._delayTimer),delete e._delayTimer,e._touchstartListener.remove(),delete e._touchstartListener});if(c.getNode("m-swipe-pymk-item")){a=b("MParent").bySigil(d,"undoable-action");if(!a)return;a=b("DOM").scry(a,"*","pymk-remove-button")[0];a&&b("CSS").hide(a)}}function c(a){a=a.getData().event;if(!a.getNode("m-swipe-pymk-item"))return;a=a.getTarget();a=b("MParent").bySigil(a,"undoable-action");if(!a)return;a=b("DOM").scry(a,"*","pymk-remove-button")[0];a&&b("CSS").show(a)}function d(a){a=a.getData();var b=a.scrollarea;k(b,a.container)}function j(a){a=JSON.parse(b("DataAttributeUtils").getDataFt(a));if(!a)return;var c=a.ego_id,d=a.qid;a=a.mf_story_key;var e=(d+a).toString();if(!c||i[e]&&i[e][c])return;var f=b("XFeedEgoImpressionLoggingController").getURIBuilder().getURI();new(b("MRequest"))(f).setMethod("POST").setData({ego_id:c,qid:d,mf_story_key:a}).send();i[e]||(i[e]={});i[e][c]=!0}function k(a,c){var d=a.getScrollPageIndex()+1,e=a.getScrollPageCount();d+h>=e&&b("MSwipeInfiniteScrollerLoadMore").maybeLoadMore(c);d=a.getChildrenOnCurrentPage();for(var e=0;e<d.length;e++)j(d[e])}function e(a){a=a.getNode("m-swipe-pymi-item");if(!a)return;var c=b("MScrollAreaHelper").findScrollArea(a);if(!c)return;window.setTimeout(function(){c.scrollByPages(1)},500)}function g(a){var c=a.getNode("m-swipe-pymk-item"),d="PYMK";c||(c=a.getNode("m-swipe-pysf-item"),d="PYSF");c||(c=a.getNode("m-swipe-pymi-item"),d="PYMI");if(!c)return;var e=b("MScrollAreaHelper").findScrollArea(c);if(!e)return;a=JSON.parse(b("DataAttributeUtils").getDataFt(c));if(a&&a.ego_id){var f=b("XEgoHideLoggingController").getURIBuilder().setInt("ego_id",a.ego_id).setInt("qid",a.qid).setInt("mf_story_key",a.mf_story_key).setString("service_id",d).getURI();new(b("MRequest"))(f).send();if(d=="PYMI"){f=b("XEgoPYMIActionsLoggingController").getURIBuilder().setString("action","xout").setInt("ego_id",a.ego_id).setString("how_found","mtouch_feed").getURI();new(b("MRequest"))(f).send()}}b("CSS").addClass(c,"_3m57");if(!e._canUseHscroll&&!e._isHorizontal){b("DOM").remove(c);return}window.setTimeout(function(){b("DOM").remove(c),b("MSwipeInfiniteScrollerLoadMore").reflow(e._element.id),k(e,e._content)},500);d=e.getScrollPageIndex()+1;a=e.getChildAtPageIndex(d);j(a)}(f=b("Stratcom")).listen("MScrollArea:scrollend","infiniteScroller",d);f.listen("click","invite-contact-button",e);f.listen(b("MFriendingState").REQUEST_SENT,null,a);f.listen(b("MFriendingState").REQUEST_CANCELED,null,c);f.listen("click","m-swipe-xout",g)}),null);
__d("MSwipeFirstUnitImpression",["MLegacyDataStore","MSwipeInfiniteScroller","MViewport","Stratcom","Vector"],(function(a,b,c,d,e,f){f.setup=a;function a(a,c){if(c){a=b("MLegacyDataStore").get(c);if(a&&a.scrollArea)g(a.scrollArea);else var d=b("Stratcom").listen("MScrollArea:create",null,function(a){a.getData().element.getAttribute("id")===c.id&&(g(a.getData().scrollarea),d&&d.remove())})}}var g=function(a){var c=a.getElement();if(h(c))i(a);else var d=b("Stratcom").listen("scroll",null,function(){h(c)&&(i(a),d&&d.remove())})},h=function(a){var c=b("MViewport").getHeight()+b("MViewport").getScrollTop(),d=a.clientHeight;a=b("Vector").getElementPosition(a).y;a=a+d;return a&&c>=a},i=function(a){var c=a.getChildAtPageIndex(0);c=Math.min(Math.floor(a.getElement().offsetWidth/c.offsetWidth),a.getNumChildren());for(var d=0;d<c;d++)b("MSwipeInfiniteScroller").logImpressionForElement(a.getChildAtPageIndex(d))}}),null);
__d("MLayerHideOnScroll",["Stratcom"],(function(a,b,c,d,e,f){var g=5;a=function(){"use strict";function a(a){this.$1=null,this.$2=null,this.$3=a,this.$4=null}var c=a.prototype;c.enable=function(){this.$1=[this.$3.addListener("show",this.$5.bind(this)),this.$3.addListener("hide",this.$6.bind(this))],this.$3.isShown()&&this.$5()};c.disable=function(){this.$6();while(this.$1.length)this.$1.pop().remove();this.$1=null};c.$6=function(){this.$2&&this.$2.remove()};c.$5=function(){var a=this,c=window;this.$4=c.scrollY;this.$2=b("Stratcom").listen("scroll",null,function(){var b=c.scrollY;Math.abs(a.$4-b)>=g&&a.$3.hide()})};return a}();e.exports=a}),null);